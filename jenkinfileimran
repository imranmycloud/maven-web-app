
pipeline {
    agent any

    environment {
        MAVEN_VERSION = '3.9.4'
        MAVEN_HOME = "${env.WORKSPACE}/apache-maven-${MAVEN_VERSION}"
        PATH = "${MAVEN_HOME}/bin:${env.PATH}"
    }
    stages {
        stage('Checkout Code') {
            steps {
                checkout scmGit(branches: [[name: '*/master']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/imranmycloud/maven-web-app.git']])
            }
        }
stage('Install Maven Build Tool') {
            steps {
                sh '''
                    wget https://dlcdn.apache.org/maven/maven-3/${MAVEN_VERSION}/binaries/apache-maven-${MAVEN_VERSION}-bin.tar.gz
                    tar -xzvf apache-maven-${MAVEN_VERSION}-bin.tar.gz
                '''
            }
        }
 stage('Build with Maven') {
            steps {
                sh 'mvn --version'
                // Example build command
                // sh 'mvn clean install'
            }
        }
        stage('Compile Application') {
            steps {
                dir('/var/lib/jenkins/workspace/test'){
                sh '/var/lib/jenkins/workspace/test/apache-maven-3.9.4/bin/mvn compile'
            }
           }
        }
stage('Test Application') {
            steps {
                dir('/var/lib/jenkins/workspace/test'){
                sh '/var/lib/jenkins/workspace/test/apache-maven-3.9.4/bin/mvn test'
            }
           }
        }
         
         stage('Package Application') {
            steps {
                dir('/var/lib/jenkins/workspace/test'){
                sh '/var/lib/jenkins/workspace/test/apache-maven-3.9.4/bin/mvn package'
            }
           }
        }
         
    }
}
